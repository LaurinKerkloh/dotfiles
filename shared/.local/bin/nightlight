#!/bin/bash

# Ensure hyprsunset is running
if ! pgrep -x hyprsunset; then
  setsid uwsm app -- hyprsunset &
  sleep 1 # Give it time to register
fi

# Query the current temperature
CURRENT_TEMP=$(hyprctl hyprsunset temperature 2>/dev/null | grep -oE '[0-9]+')

if [ "$CURRENT_TEMP" -ge 4000 ]; then
    CURRENT_TEMP=3000
elif [ "$CURRENT_TEMP" -ge 3000 ]; then
    CURRENT_TEMP=2000
elif [ "$CURRENT_TEMP" -ge 2000 ]; then
    CURRENT_TEMP=1000
else
    CURRENT_TEMP=6000
fi

hyprctl hyprsunset temperature "$CURRENT_TEMP"
